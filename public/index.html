<!-- Sección de visualización -->
<section>
  <h2>Visualizar Registros</h2>
  <button onclick="cargarDatos()">Ver Todos los Registros</button>
  <div id="tabla-container"></div>
</section>

<script>
async function cargarDatos() {
  const urls = [
    { url: '/api/botes', titulo: 'Botes de Basura' },
    { url: '/api/materiales', titulo: 'Materiales Reciclables' },
    { url: '/api/participantes', titulo: 'Participantes' },
    { url: '/api/rutas', titulo: 'Rutas de Recolección' }
  ];

  const contenedor = document.getElementById('tabla-container');
  contenedor.innerHTML = ''; // limpiar resultados anteriores

  for (const item of urls) {
    try {
      const res = await fetch(item.url);
      const datos = await res.json();

      if (datos.length === 0) continue;

      const tabla = document.createElement('table');
      tabla.border = '1';
      tabla.style.marginBottom = '20px';

      // Encabezado
      const encabezado = tabla.insertRow();
      Object.keys(datos[0]).forEach(clave => {
        if (clave !== '__v' && clave !== '_id') {
          const th = document.createElement('th');
          th.textContent = clave;
          encabezado.appendChild(th);
        }
      });

      // Filas
      datos.forEach(registro => {
        const fila = tabla.insertRow();
        Object.keys(registro).forEach(clave => {
          if (clave !== '__v' && clave !== '_id') {
            const celda = fila.insertCell();
            celda.textContent = registro[clave];
          }
        });
      });

      // Agregar tabla al contenedor
      const titulo = document.createElement('h3');
      titulo.textContent = item.titulo;
      contenedor.appendChild(titulo);
      contenedor.appendChild(tabla);

    } catch (error) {
      console.error('Error cargando', item.url, error);
    }
  }
}
</script>
